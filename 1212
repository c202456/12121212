<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ—…éŠåˆ†äº«å™¨æ–¹æ¡ˆç”Ÿæˆå™¨</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 600px; margin: auto; }
    input, select { margin: 5px 0; padding: 5px; width: 100%; }
    button { margin: 10px 0; padding: 10px 20px; cursor: pointer; }
    #plansOutput, #modifyResultOutput { white-space: pre-wrap; background: #f2f2f2; padding: 10px; border-radius: 5px; margin-top: 10px; }
    h3 { margin-top: 30px; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <h2>æ—…éŠåˆ†äº«å™¨æ–¹æ¡ˆç”Ÿæˆå™¨</h2>

  <label>é¸æ“‡æˆ–è¼¸å…¥åœ‹å®¶ï¼š</label>
  <input list="countries" id="countryInput" placeholder="ä¾‹å¦‚ï¼šæ—¥æœ¬">
  <datalist id="countries">
    <option value="æ—¥æœ¬">
    <option value="éŸ“åœ‹">
    <option value="ä¸­åœ‹">
    <option value="æ³°åœ‹">
    <option value="è¶Šå—">
    <option value="å°ç£">
    <option value="ç¾åœ‹">
  </datalist>

  <label>è¼¸å…¥å„ªæƒ ä»£ç¢¼ï¼ˆå¯ç•™ç©ºä½¿ç”¨é è¨­ 85GOï¼‰ï¼š</label>
  <input type="text" id="customCodeInput" placeholder="ä¾‹å¦‚ï¼šTAG60" value="85GO">

  <label>æŠ˜æ‰£ç™¾åˆ†æ¯”ï¼ˆå¦‚ 85 = 85æŠ˜ï¼Œé è¨­ 85ï¼‰ï¼š</label>
  <input type="number" id="discountInput" value="85">

  <label>åˆ†äº«å™¨åŸåƒ¹èª¿æ•´ï¼ˆè‹¥å›ºå®šå‰‡ç„¡æ³•ä¿®æ”¹ï¼‰ï¼š</label>
  <input type="number" id="customPriceInput" placeholder="è¼¸å…¥æ–°çš„åŸåƒ¹ï¼Œå–®ä½å…ƒ/å¤©">

  <button id="copyBtn">ä¸€éµè¤‡è£½æ–¹æ¡ˆ</button>

  <div id="plansOutput"></div>

  <h3>åœ‹å®¶æ–¹æ¡ˆæŸ¥è©¢èˆ‡ä¿®æ”¹</h3>
  <label>é¸æ“‡åœ‹å®¶ï¼š</label>
  <select id="modifyCountryInput"></select>

  <div id="countryPlansDisplay">
    <label>åˆ†äº«å™¨åŸåƒ¹ï¼š</label>
    <input id="modifySharePriceInput" type="number">
    <label>åˆ†äº«å™¨é€£çµï¼š</label>
    <input id="modifyShareLinkInput">
    <div id="esimDiv" class="hidden">
      <label>æ˜¯å¦æœ‰å¯¦é«” SIM å¡ï¼š</label>
      <select id="hasPhysicalSIMInput">
        <option value="yes">æœ‰</option>
        <option value="no">ç„¡</option>
      </select>
      <label>eSIM é€£çµï¼ˆè¼¸å…¥ç¶²å€è¡¨ç¤ºæœ‰eSIMï¼‰ï¼š</label>
      <input id="modifyEsimLinkInput">
    </div>
    <button id="saveModifyBtn">å„²å­˜ä¿®æ”¹</button>
    <div id="modifyResultOutput"></div>
  </div>

  <h3>æ–°å¢æœªåœ¨é¸é …çš„åœ‹å®¶æ–¹æ¡ˆ</h3>
  <label>åœ‹å®¶åç¨±ï¼š</label>
  <input id="newCountryInput" placeholder="ä¾‹å¦‚ï¼šè²å¾‹è³“">
  <label>åˆ†äº«å™¨åŸåƒ¹ï¼š</label>
  <input type="number" id="newSharePriceInput" placeholder="ä¾‹å¦‚ï¼š200">
  <label>åˆ†äº«å™¨é€£çµï¼š</label>
  <input id="newShareLinkInput" placeholder="ä¾‹å¦‚ï¼šhttps://example.com/share">
  <label>æ˜¯å¦æœ‰å¯¦é«” SIM å¡ï¼š</label>
  <select id="newHasPhysicalSIMInput">
    <option value="yes">æœ‰</option>
    <option value="no">ç„¡</option>
  </select>
  <label>eSIM é€£çµï¼ˆè¼¸å…¥ç¶²å€è¡¨ç¤ºæœ‰eSIMï¼‰ï¼š</label>
  <input id="newEsimLinkInput" placeholder="ä¾‹å¦‚ï¼šhttps://example.com/esim">
  <button id="addNewCountryBtn">æ–°å¢åœ‹å®¶æ–¹æ¡ˆ</button>

  <script>
    const fixedPlans = ["æ—¥æœ¬", "éŸ“åœ‹", "æ³°åœ‹", "è¶Šå—", "å°ç£"];

    const plansData = {
      "æ—¥æœ¬": [
        { type: "åˆ†äº«å™¨", originalPrice: 190, discountCode: "TAG60", link: "bit.ly/2LNwLOk", suggestion: "1-3å°é€£ç·šä½¿ç”¨(æœ€å¤š5å°)" },
        { type: "eSIM/å¯¦é«”SIMå¡", discountCode: "85GO", link: "reurl.cc/nvZ612" }
      ],
      "éŸ“åœ‹": [
        { type: "åˆ†äº«å™¨", originalPrice: 190, discountCode: "TAG60", link: "bit.ly/2E92zM2", suggestion: "1-3å°é€£ç·šä½¿ç”¨(æœ€å¤š5å°)" },
        { type: "eSIM/å¯¦é«”SIMå¡", discountCode: "85GO", link: "reurl.cc/OrE7j7" }
      ],
      "ç¾åœ‹": [
        { type: "åˆ†äº«å™¨", originalPrice: 250, discountCode: "US70", link: "bit.ly/USAshare", suggestion: "1-3å°é€£ç·šä½¿ç”¨(æœ€å¤š5å°)" }
      ],
      "æ³°åœ‹": [
        { type: "åˆ†äº«å™¨", originalPrice: 190, discountCode: "TAG60", link: "reurl.cc/OMr25D", suggestion: "1-3å°é€£ç·šä½¿ç”¨(æœ€å¤š5å°)" },
        { type: "eSIM/å¯¦é«”SIMå¡", discountCode: "85GO", link: "reurl.cc/NQkqEk" }
      ],
      "ä¸­åœ‹": [
        { type: "åˆ†äº«å™¨", originalPrice: 250, discountCode: "85GO", link: "goo.gl/U6JVyj", suggestion: "1-3å°é€£ç·šä½¿ç”¨(æœ€å¤š5å°)" },
        { type: "eSIM/å¯¦é«”SIMå¡", discountCode: "85GO", link: "reurl.cc/zqbRWa" },
        { type: "äºæ´²8åœ‹ä¸Šç¶² - eSIM/å¯¦é«”SIMå¡", discountCode: "85GO", link: "reurl.cc/rEaGZr" }
      ],
      "è¶Šå—": [
        { type: "åˆ†äº«å™¨", originalPrice: 190, discountCode: "TAG60", link: "reurl.cc/jWoDzp", suggestion: "1-3å°é€£ç·šä½¿ç”¨(æœ€å¤š5å°)" },
        { type: "eSIM/å¯¦é«”SIMå¡", discountCode: "85GO", link: "reurl.cc/OMnvOy" }
      ],
      "å°ç£": [
        { type: "åˆ†äº«å™¨", originalPrice: 190, discountCode: "1FCB26E2FA", link: "bit.ly/2Nb1SEJ", suggestion: "1-3å°é€£ç·šä½¿ç”¨(æœ€å¤š5å°)" }
      ]
    };

    // åˆå§‹åŒ–åœ‹å®¶ä¸‹æ‹‰é¸å–®
    const modifyCountrySelect = document.getElementById('modifyCountryInput');
    function updateModifyCountryOptions() {
      modifyCountrySelect.innerHTML = '';
      Object.keys(plansData).forEach(c => {
        const option = document.createElement('option');
        option.value = c;
        option.text = c;
        modifyCountrySelect.add(option);
      });
    }
    updateModifyCountryOptions();

    // ç”Ÿæˆæ–¹æ¡ˆ
    function generatePlans() {
      let country = document.getElementById('countryInput').value.trim();
      if(!plansData[country]) { 
        document.getElementById('plansOutput').innerText = 'æ‰¾ä¸åˆ°è©²åœ‹æ–¹æ¡ˆ'; 
        return; 
      }
      const discountPercent = document.getElementById('discountInput').value;
      const customCode = document.getElementById('customCodeInput').value.trim() || '85GO';
      const customPrice = document.getElementById('customPriceInput').value;
      let outputText = '';

      plansData[country].forEach(plan => {
        if(plan.type === 'åˆ†äº«å™¨') {
          let priceToUse = plan.originalPrice;
          if(!fixedPlans.includes(country)) {
            if(customPrice) priceToUse = Number(customPrice);
          }
          const discounted = Math.round(priceToUse * (discountPercent/100));
          const codeToUse = (fixedPlans.includes(country) ? plan.discountCode : customCode || plan.discountCode);
          outputText += `ã€${country}ä¸Šç¶² - ${plan.type}ã€‘\n`;
          outputText += `â–ªåŸåƒ¹${priceToUse}å…ƒ/å¤©\nâ–ªå„ªæƒ ${discounted}å…ƒ/å¤©\n`;
          if(plan.suggestion) outputText += `â–ª${plan.suggestion}\n`;
          outputText += `--------------------\nğŸ‘‰å„ªæƒ ä»£ç¢¼ï¼š ${codeToUse}\nğŸ‘‰æ–¹æ¡ˆä»‹ç´¹ï¼š ${plan.link}\n\n`;
        } else if(plan.type.includes('eSIM')) {
          outputText += `ã€${country}ä¸Šç¶² - ${plan.type}ã€‘\n`;
          outputText += `ğŸ‘‰å„ªæƒ ä»£ç¢¼ï¼š ${plan.discountCode}\nğŸ‘‰æ–¹æ¡ˆä»‹ç´¹ï¼š ${plan.link}\n\n`;
        }
      });
      document.getElementById('plansOutput').innerText = outputText;
    }

    function copyPlans() {
      const plansText = document.getElementById('plansOutput').innerText;
      navigator.clipboard.writeText(plansText);
      alert('æ–¹æ¡ˆå·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼');
    }

    // é¸åœ‹å®¶è‡ªå‹•ç”Ÿæˆæ–¹æ¡ˆ
    document.getElementById('countryInput').addEventListener('change', generatePlans);
    document.getElementById('copyBtn').addEventListener('click', copyPlans);

    // é¸æ“‡åœ‹å®¶é¡¯ç¤ºæ–¹æ¡ˆè³‡æ–™
    modifyCountrySelect.addEventListener('change', function() {
      const country = this.value;
      const sharePlan = plansData[country]?.find(p => p.type === 'åˆ†äº«å™¨');
      const esimPlan = plansData[country]?.find(p => p.type.includes('eSIM'));

      document.getElementById('modifySharePriceInput').value = sharePlan?.originalPrice || '';
      document.getElementById('modifyShareLinkInput').value = sharePlan?.link || '';

      if(esimPlan?.link) {
        document.getElementById('esimDiv').classList.remove('hidden');
        document.getElementById('modifyEsimLinkInput').value = esimPlan.link;
        document.getElementById('hasPhysicalSIMInput').value = 'yes';
      } else {
        document.getElementById('esimDiv').classList.add('hidden');
        document.getElementById('modifyEsimLinkInput').value = '';
        document.getElementById('hasPhysicalSIMInput').value = 'no';
      }

      generatePlans();
    });

    // å„²å­˜ä¿®æ”¹
    document.getElementById('saveModifyBtn').addEventListener('click', function() {
      const country = modifyCountrySelect.value;
      const sharePlan = plansData[country]?.find(p => p.type === 'åˆ†äº«å™¨');
      const esimPlan = plansData[country]?.find(p => p.type.includes('eSIM'));

      const newSharePrice = Number(document.getElementById('modifySharePriceInput').value);
      const newShareLink = document.getElementById('modifyShareLinkInput').value.trim();
      const newEsimLink = document.getElementById('modifyEsimLinkInput').value.trim();
      const hasPhysicalSIM = document.getElementById('hasPhysicalSIMInput').value === 'yes';
      const outputDiv = document.getElementById('modifyResultOutput');

      if(sharePlan && !fixedPlans.includes(country)) sharePlan.originalPrice = newSharePrice;
      if(sharePlan) sharePlan.link = newShareLink;

      if(newEsimLink) {
        if(esimPlan) {
          esimPlan.link = newEsimLink;
        } else {
          plansData[country].push({ type: 'eSIM/å¯¦é«”SIMå¡', discountCode: '85GO', link: newEsimLink });
        }
      }

      outputDiv.innerText = 'ä¿®æ”¹å®Œæˆï¼';
      generatePlans();
    });

    // æ–°å¢åœ‹å®¶æ–¹æ¡ˆ
    document.getElementById('addNewCountryBtn').addEventListener('click', function() {
      const country = document.getElementById('newCountryInput').value.trim();
      const sharePrice = Number(document.getElementById('newSharePriceInput').value);
      const shareLink = document.getElementById('newShareLinkInput').value.trim();
      const esimLink = document.getElementById('newEsimLinkInput').value.trim();

      if(!country || !sharePrice || !shareLink) { alert('è«‹è‡³å°‘å¡«å¯«åœ‹å®¶åç¨±ã€åˆ†äº«å™¨åŸåƒ¹åŠé€£çµ'); return; }

      plansData[country] = [{ type: 'åˆ†äº«å™¨', originalPrice: sharePrice, discountCode: '85GO', link: shareLink }];
      if(esimLink) plansData[country].push({ type: 'eSIM/å¯¦é«”SIMå¡', discountCode: '85GO', link: esimLink });

      // æ›´æ–°ä¸‹æ‹‰é¸å–®
      updateModifyCountryOptions();

      alert('æ–°å¢åœ‹å®¶æ–¹æ¡ˆå®Œæˆ');
    });

    // åˆæ¬¡è§¸ç™¼é¡¯ç¤ºæ–¹æ¡ˆ
    modifyCountrySelect.dispatchEvent(new Event('change'));
  </script>
</body>
</html>
